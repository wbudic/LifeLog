#Install tiny thttpd web server.

https://acme.com/software/thttpd/

wget https://acme.com/software/thttpd/thttpd-2.29.tar.gz
tar -xvzf thttpd-2.29.tar.gz
cd thttpd-2.29/
sudo groupadd www
make
make install

#rm thttpd-2.29.tar.gz
#rm -rf thttpd-2.29

Create an mkdir ~/thttpd_dev directory.

Run server using this config file, where {user} is your home login location.


# This section overrides defaults
dir=/home/{user}/thttpd_dev/htdocs
user={user}
logfile=/home/{user}/thttpd_dev/log/thttpd.log
pidfile=/home/{user}/thttpd_dev/run/thttpd.pid
# This section _documents_ defaults in effect
port=8080
# nosymlink# default = !chroot
# novhost
# nocgipat
# nothrottles
host=0.0.0.0
charset=utf-8
cgipat=**.cgi

After modifying the thttpd.conf
you'll have to modify the startDevWebServer.sh to reflect your setup before running the script.

The full URL to the LifeLog is the following link (if not working try without cgi-bin, and proceed with further installation):
#
#
         http://localhost:8080/cgi-bin/
#
#

#Install cpanm to make installing other modules easier (you'll thank us later). 
You need to type these commands into a Terminal emulator (Mac OS X, Win32, Linux)
sudo apt install cpanminus

#Install DBI module
sudo cpanm DBI

#Install SQLite
https://www.sqlite.org/download.html


#Install or make sure you have following perl modules.
 
sudo cpanm DateTime;
sudo cpanm DateTime::Format::Human::Duration
sudo cpanm DateTime::Format::SQLite;
sudo cpanm Text::CSV;
sudo cpanm CGI::Session;
sudo cpanm TryCatch;
sudo cpanm Number/Bytes/Human.pm
sudo cpanm Regexp::Common


#Upgrade Instructions

To upgrade to newer version of this software requires data migration.
Before installing newer version scripts, perform an data export.

cd /home/{user}/thttpd_dev/dbLifeLog
sqlite3 -csv data_log.db "select * from LOG;" > current_log.csv

##Install LifeLog Independantly
cd /home/{user}/ 
git clone https://github.com/wbudic/LifeLog
mkdir /home/{user}/thttpd_dev/dbLifeLog

Copy from /home/{user}/LifeLog/htdocs/cgi-bin to /home/{user}/thttpd_dev/htdocs/cgi-bin
if doing development. Copy also the /home/{user}/LifeLog/.git to /home/{user}/thttpd_dev/

Access the webserver cgi-bin. http://localhost:8080/cgi-bin/main.cgi
(this might redirect to login.cgi or config.cgi in the future)

##Install LifeLog Dependatly (not automatic, manual developer way)
cd /home/{user}/ 
git clone https://github.com/wbudic/LifeLog
run thttpd with:
cd LifeLog; ./startDevWebServer.sh

##Import CSV Exported File
This requires all CGI working. As it will creat a brand new database for you.
Once created you must import the from above example current_log.csv
cd /home/{user}/thttpd_dev/dbLifeLog
see: http://www.sqlitetutorial.net/sqlite-import-csv/

Example (data_dev1_2_log.db would be created as the latest version by the CGI created): 
cd /home/{user}/thttpd_dev/dbLifeLog
sqlite3 data_dev1_2_log.db
sqlite> .mode csv
sqlite> .import curren_log.csv LOG;
sqlite> select * FROM LOG;
sqlite>.quit

Note exporting/importing of other tables is similar, but not recommended.


#Current Latest Development Branch
git fetch && git checkout dev.1.3


#Install thttpd_dev as an Linux System Service
Not recommended, but the thttpd development environment for LifeLog
can be installed to start on reboot.

sudo cp startDevWebServer.sh  /etc/init.d/

Modify the following to the path of your development environment 
where thttpd.conf file is in /etc/init.d/startDevWebServer.sh

Modify line -> cd /home/will/thttpd_dev
vim /etc/init.d/startDevWebServer.sh

Install as service with:
sudo update-rc.d startDevWebServer.sh defaults



